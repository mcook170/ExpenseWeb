<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Tracker</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="{{ theme }}">
  <!-- Main Content -->
  <div class="page-wrapper">
    <main class="main-content">
      <div class="form">
        <h2>Hello, {{ username }} ğŸ‘‹</h2>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="flash-message">
              {% for message in messages %}
                <p>{{ message }}</p>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <!-- Form -->
        <form method="POST">
          <div class="form-group">
            <label for="description">Description</label>
            <input type="text" name="description" id="description" class="form-input" required>
          </div>

          <div class="form-group">
            <label for="expense_type">Type</label>
            <select name="expense_type" id="expense_type" class="form-input" required>
              <option value="Food/Drink">Food/Drink</option>
              <option value="Health">Health</option>
              <option value="Entertainment">Entertainment</option>
              <option value="Shopping">Shopping</option>
              <option value="Deposit">Deposit</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="form-group">
            <label for="amount">Amount</label>
            <input type="number" name="amount" id="amount" class="form-input" step="0.01" required>
          </div>

          <div class="form-group">
            <label for="note">Note</label>
            <input type="text" name="note" id="note" class="form-input">
          </div>

          <div class="form-buttons">
            <button type="submit" class="form-button">Add Expense</button>
          </div>
        </form>
<div class="expense-table">
  {% if entries %}
    <!-- Expense Table -->
    <table>
      <tr>
        <th>Date</th><th>Type</th><th>Description</th><th>Amount</th><th>Note</th>
      </tr>
        <tbody>
          {% for entry in entries %}
          <tr>
            <td>{{ entry.date.strftime("%m/%d/%Y") }}</td>
            <td>{{ entry.expense_type }}</td>
            <td>{{ entry.description }}</td>
            <td>{{ "%.2f" | format(entry.amount) }}</td>
            <td>{{ entry.note }}</td>
          </tr>
          {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No expenses recorded yet. Add one to get started!</p>
  {% endif %}
</div>

<!-- Menu Dropdown -->
</div>
    </main>
  </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const toggle = document.getElementById("settings-toggle");
        const dropdown = document.getElementById("settings-dropdown");
        toggle.addEventListener("click", () => {
          dropdown.classList.toggle("hidden");
        });
      });
    </script>
  
    <!-- Settings -->
    <div class="settings-wrapper">
      <button id="settings-toggle">ğŸŒ</button>
      <div class="dropdown hidden" id="dropdown-menu">
          <a href="{{ url_for('download') }}">ğŸŒµ Download Workbook</a>
          <form action="{{ url_for('refresh_workbook') }}" method="POST">
              <button type="submit">ğŸœï¸ Refresh Template</button>
          </form>
          <a href="{{ url_for('all_expenses')}}">ğŸŒŠ View All Expenses (Web)</a>
          <form action="{{ url_for('delete_account') }}" method="POST">
              <button type="submit" onclick="return confirm('Delete your account and workbook?')">ğŸ« Delete Account</button>
          </form>
          <div class="theme-menu">
            <span class="menu-title">Set Theme â–¸</span>
             <div class="theme-options">
                <a href="{{ url_for('set_theme', theme='desert-theme') }}">Desert</a>
                <a href="{{ url_for('set_theme', theme='dark-theme') }}">Dark</a>
                <a href="{{ url_for('set_theme', theme='forest-theme') }}">Forest</a>
             </div>
          </div>
          <a href="{{ url_for('logout') }}">ğŸšª Logout</a>
      </div>
    </div>
  </body>
      <script>
        const toggleBtn = document.getElementById("settings-toggle");
        const dropdown = document.getElementById("dropdown-menu");

        toggleBtn.addEventListener("click", () => {
          dropdown.classList.toggle("show"); // toggles visibility
        });

        // Optional: close dropdown if clicking outside
        document.addEventListener("click", (e) => {
          if (!dropdown.contains(e.target) && !toggleBtn.contains(e.target)) {
            dropdown.classList.remove("show");
          }
        });
      </script>
</html>